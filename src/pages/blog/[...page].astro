---
import Layout from "~/layouts/PageLayout.astro";
import { SITE } from "~/config.mjs";
import { getPosts } from "~/utils/getPosts";
import BlogList from "~/components/widgets/BlogList.astro";
import Pagination from "~/components/widgets/Pagination.astro";

interface PaginateFunction<T> {
  (data: T[], options: { pageSize: number }): {
    data: T[];
    totalPages: number;
  };
}

export async function getStaticPaths({ paginate }: { paginate: PaginateFunction<any> }) {
  const posts = await getPosts();
  return paginate(posts, {
    pageSize: SITE.postsPerPage,
  });
}

const { page } = Astro.props;
const currentPage = page.currentPage ?? 1;
const title = `Blog ${currentPage > 1 ? `— Page ${currentPage} ` : ""}— ${
  SITE.name
}`;
const description = 'tanayan\'s portfolio site';
const canonical = new URL(page.url.current, Astro.site);
---

<Layout meta={{ title, description, canonical }}>
  <main>
    <BlogList page={page} />
  </main>
</Layout>